{
	"info": {
		"_postman_id": "b110cd47-4602-4222-a0e1-225c037fe953",
		"name": "Bulk_API_Transfers_MojaSims",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Positive Scenarios",
			"item": [
				{
					"name": "POST Bulk Transfer",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "f627305e-3674-4d51-8061-93d3ca1f46eb",
								"exec": [
									"const uuid = require('uuid');",
									"",
									"const delay = 1000 * 3600 * 24",
									"const bulkTransferId = uuid.v4();",
									"const bulkQuoteId = uuid.v4();",
									"const transferId = uuid.v4();",
									"const transferId2 = uuid.v4();",
									"const now = new Date();",
									"const headerDate = now.toUTCString();",
									"const expirationDate = new Date(now.getTime() + delay).toISOString();",
									"const completedTimestamp = now.toISOString();",
									"",
									"pm.environment.set(\"bulkTransferId\", bulkTransferId);",
									"pm.environment.set(\"bulkQuoteId\", bulkQuoteId);",
									"pm.environment.set(\"transferId\", transferId);",
									"pm.environment.set(\"transferId2\", transferId2);",
									"pm.environment.set(\"headerDate\", headerDate);",
									"pm.environment.set(\"expirationDate\", expirationDate);",
									"pm.environment.set(\"completedTimestamp\", completedTimestamp);",
									"pm.environment.set(\"amount\", 1);",
									"pm.environment.set(\"amount2\", 1);",
									"pm.environment.set(\"currency2\", \"USD\");",
									"pm.environment.set(\"acceptHeader\", \"application/vnd.interoperability.bulkTransfers+json;version=1\");",
									"pm.environment.set(\"contentType\", \"application/vnd.interoperability.bulkTransfers+json;version=1.0\");",
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "e63bb466-6039-4072-8f68-ade47f5b4136",
								"exec": [
									"pm.test(\"Status code is 202\", function () {",
									"    pm.response.to.have.status(202);",
									"});",
									"",
									"setTimeout(function () {",
									"    pm.sendRequest(pm.environment.get(\"PAYEEFSP_SDK_TESTAPI_URL\") + \"/requests/\" + pm.environment.get(\"bulkTransferId\"), function (err, response) {",
									"        if (response.responseSize !== 0) {",
									"            const jsonResponse = response.json();",
									"",
									"            const headers = jsonResponse.headers",
									"            pm.test(\"date header should be set\", function () {",
									"                pm.expect(headers.date).to.be.ok;",
									"            });",
									"            pm.test(\"fspiop-source should be payerfsp\", function () {",
									"                pm.expect(headers[\"fspiop-source\"]).to.eql('payerfsp');",
									"            });",
									"            pm.test(\"fspiop-destination should be payeefsp\", function () {",
									"                pm.expect(headers[\"fspiop-destination\"]).to.eql('payeefsp');",
									"            });",
									"            pm.test(\"fspiop-http-method should be POST\", function () {",
									"                pm.expect(headers[\"fspiop-http-method\"]).to.eql('POST');",
									"            });",
									"            pm.test(\"fspiop-uri should be /bulkTransfers\", function () {",
									"                pm.expect(headers[\"fspiop-uri\"]).to.eql(\"/bulkTransfers\");",
									"            });",
									"            pm.test(\"fspiop-signature should be set\", function () {",
									"                pm.expect(headers[\"fspiop-signature\"]).to.be.ok;",
									"            });",
									"",
									"",
									"            const data = jsonResponse.data",
									"            pm.test(\"Bulk transfer Id should be set\", function () {",
									"                pm.expect(data.bulkTransferId).to.eql(pm.environment.get(\"bulkTransferId\"));",
									"            });",
									"            pm.test(\"Bulk quote Id should be set\", function () {",
									"                pm.expect(data.bulkQuoteId).to.eql(pm.environment.get(\"bulkQuoteId\"));",
									"            });",
									"            pm.test(\"PayerFsp should be 'payerfsp'\", function () {",
									"                pm.expect(data.payerFsp).to.eql(\"payerfsp\");",
									"            });",
									"            pm.test(\"PayeeFsp should be 'payeefsp'\", function () {",
									"                pm.expect(data.payeeFsp).to.eql(\"payeefsp\");",
									"            });",
									"            pm.test(\"expiration should be set\", function () {",
									"                pm.expect(data.expiration).to.be.ok;",
									"            });",
									"            pm.test(\"All individual transfers (prepare) should be sent\", function () {",
									"                pm.expect(data.individualTransfers.length).to.eql(2);",
									"            });",
									"            const transfer1 = data.individualTransfers.find(t => t.transferId === pm.environment.get(\"transferId\"));",
									"            pm.test(\"1st individual transfer should have valid ilpPacket\", function () {",
									"                pm.expect(transfer1.ilpPacket).to.eql(pm.environment.get(\"validIlpPacket2\"))",
									"            });",
									"            pm.test(\"1st individual transfer should have valid condition\", function () {",
									"                pm.expect(transfer1.condition).to.eql(pm.environment.get(\"validCondition2\"))",
									"            });",
									"            pm.expect(JSON.stringify(transfer1.transferAmount)).to.eql(JSON.stringify({ amount: \"1\", currency: \"USD\" }))",
									"            pm.expect(JSON.stringify(transfer1.extensionList)).to.eql(JSON.stringify({ extension: [{key: \"extKey1\", value: \"extValue1\"}, { key: \"extKey2\", value: \"extValue2\" }]}))",
									"            ",
									"            const transfer2 = data.individualTransfers.find(t => t.transferId === pm.environment.get(\"transferId2\"));",
									"            pm.test(\"2nd individual transfer should have valid ilpPacket\", function () {",
									"                pm.expect(transfer2.ilpPacket).to.eql(pm.environment.get(\"validIlpPacket2\"))",
									"            });",
									"            pm.test(\"2nd individual transfer should have valid condition\", function () {",
									"                pm.expect(transfer2.condition).to.eql(pm.environment.get(\"validCondition2\"))",
									"            });",
									"            pm.expect(JSON.stringify(transfer2.transferAmount)).to.eql(JSON.stringify({ amount: \"1\", currency: \"USD\" }))",
									"        } else {",
									"            pm.test(\"Transfer FAILED\", function () {",
									"                throw new Error('Did not receive response');",
									"            });",
									"        }",
									"    });",
									"",
									"    pm.sendRequest(pm.environment.get(\"PAYEEFSP_SDK_TESTAPI_URL\") + \"/callbacks/\" + pm.environment.get(\"bulkTransferId\"), function (err, response) {",
									"        if (response.responseSize !== 0) {",
									"            const jsonResponse = response.json();",
									"",
									"            const headers = jsonResponse.headers",
									"            pm.test(\"date header should be set\", function () {",
									"                pm.expect(headers.date).to.be.ok;",
									"            });",
									"            pm.test(\"fspiop-source should be switch\", function () {",
									"                pm.expect(headers[\"fspiop-source\"]).to.eql('switch');",
									"            });",
									"            pm.test(\"fspiop-destination should be payeefsp\", function () {",
									"                pm.expect(headers[\"fspiop-destination\"]).to.eql('payeefsp');",
									"            });",
									"            pm.test(\"fspiop-http-method should be PUT\", function () {",
									"                pm.expect(headers[\"fspiop-http-method\"]).to.eql('PUT');",
									"            });",
									"            pm.test(\"fspiop-uri should be /payeefsp/bulkTransfers/\" + pm.environment.get(\"bulkTransferId\"), function () {",
									"                pm.expect(headers[\"fspiop-uri\"]).to.eql(\"/payeefsp/bulkTransfers/\" + pm.environment.get(\"bulkTransferId\"));",
									"            });",
									"            pm.test(\"fspiop-signature should not be set\", function () {",
									"                pm.expect(headers[\"fspiop-signature\"]).to.eql(undefined);",
									"            });",
									"",
									"",
									"            const data = jsonResponse.data",
									"            pm.test(\"Bulk Transfer state should be COMPLETED on Payee side\", function () {",
									"                pm.expect(data.bulkTransferState).to.eql('COMPLETED');",
									"            });",
									"            pm.test(\"Completed timestamp should be set\", function () {",
									"                pm.expect(data.completedTimestamp).to.be.ok;",
									"            });",
									"            pm.test(\"All individual transfer results (fulfilments) should be returned\", function () {",
									"                pm.expect(data.individualTransferResults.length).to.eql(2);",
									"            });",
									"            const transfer1 = data.individualTransferResults.find(t => t.transferId === pm.environment.get(\"transferId\"));",
									"            pm.test(\"1st individual transfer should have fulfilment\", function () {",
									"                pm.expect(transfer1.fulfilment).to.be.ok",
									"            });",
									"            const transfer2 = data.individualTransferResults.find(t => t.transferId === pm.environment.get(\"transferId2\"));",
									"            pm.test(\"2nd individual transfer should have fulfilment\", function () {",
									"                pm.expect(transfer2.fulfilment).to.be.ok",
									"            });",
									"        } else {",
									"            pm.test(\"Transfer FAILED\", function () {",
									"                throw new Error('Did not receive response');",
									"            });",
									"        }",
									"    });",
									"",
									"    pm.sendRequest(pm.environment.get(\"PAYERFSP_SDK_TESTAPI_URL\") + \"/callbacks/\" + pm.environment.get(\"bulkTransferId\"), function (err, response) {",
									"        if (response.responseSize !== 0) {",
									"            const jsonResponse = response.json();",
									"",
									"            const headers = jsonResponse.headers",
									"            pm.test(\"date header should be set\", function () {",
									"                pm.expect(headers.date).to.be.ok;",
									"            });",
									"            pm.test(\"fspiop-source should be payeefsp\", function () {",
									"                pm.expect(headers[\"fspiop-source\"]).to.eql('payeefsp');",
									"            });",
									"            pm.test(\"fspiop-destination should be payerfsp\", function () {",
									"                pm.expect(headers[\"fspiop-destination\"]).to.eql('payerfsp');",
									"            });",
									"            pm.test(\"fspiop-http-method should be PUT\", function () {",
									"                pm.expect(headers[\"fspiop-http-method\"]).to.eql('PUT');",
									"            });",
									"            pm.test(\"fspiop-uri should be /payerfsp/bulkTransfers/\" + pm.environment.get(\"bulkTransferId\"), function () {",
									"                pm.expect(headers[\"fspiop-uri\"]).to.eql(\"/payerfsp/bulkTransfers/\" + pm.environment.get(\"bulkTransferId\"));",
									"            });",
									"            pm.test(\"fspiop-signature should be set\", function () {",
									"                pm.expect(headers[\"fspiop-signature\"]).to.be.ok;",
									"            });",
									"",
									"",
									"            const data = jsonResponse.data",
									"            pm.test(\"Bulk Transfer state should be COMPLETED on Payer side\", function () {",
									"                pm.expect(data.bulkTransferState).to.eql('COMPLETED');",
									"            });",
									"            pm.test(\"Completed timestamp should be set\", function () {",
									"                pm.expect(data.completedTimestamp).to.be.ok;",
									"            });",
									"            pm.test(\"All individual transfer results (failed & successful) should be returned\", function () {",
									"                pm.expect(data.individualTransferResults.length).to.eql(2);",
									"            });",
									"            const transfer1 = data.individualTransferResults.find(t => t.transferId === pm.environment.get(\"transferId\"));",
									"            pm.test(\"1st individual transfer should have fulfilment\", function () {",
									"                pm.expect(transfer1.fulfilment).to.be.ok",
									"            });",
									"            const transfer2 = data.individualTransferResults.find(t => t.transferId === pm.environment.get(\"transferId2\"));",
									"            pm.test(\"2nd individual transfer should have fulfilment\", function () {",
									"                pm.expect(transfer2.fulfilment).to.be.ok",
									"            });",
									"           ",
									"        } else {",
									"            pm.test(\"Transfer FAILED\", function () {",
									"                throw new Error('Did not receive response');",
									"            });",
									"",
									"        }",
									"    });",
									"}, 3000)"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"name": "Content-Type",
								"type": "text",
								"value": "{{contentType}}"
							},
							{
								"key": "Date",
								"value": "{{headerDate}}"
							},
							{
								"key": "Accept",
								"value": "{{acceptHeader}}"
							},
							{
								"key": "FSPIOP-Source",
								"value": "{{payerfsp}}"
							},
							{
								"key": "FSPIOP-Destination",
								"value": "{{payeefsp}}"
							},
							{
								"key": "FSPIOP-Signature",
								"type": "text",
								"value": "~~{{payerfsp}}~~"
							},
							{
								"key": "FSPIOP-URI",
								"type": "text",
								"value": "/bulkTransfers"
							},
							{
								"key": "FSPIOP-HTTP-Method",
								"value": "POST",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{ \n    \"bulkTransferId\": \"{{bulkTransferId}}\",\n    \"bulkQuoteId\": \"{{bulkQuoteId}}\",\n    \"payeeFsp\": \"{{payeefsp}}\",\n    \"payerFsp\": \"{{payerfsp}}\",\n    \"individualTransfers\":\n    [ {\n        \"transferId\": \"{{transferId}}\",\n        \"transferAmount\": {\n            \"currency\": \"{{currency}}\",\n            \"amount\": \"{{amount}}\"\n        },\n        \"ilpPacket\": \"{{validIlpPacket2}}\",\n        \"condition\": \"{{validCondition2}}\",\n        \"extensionList\": { \"extension\": [\n            { \"key\": \"extKey1\", \"value\": \"extValue1\"},\n            { \"key\": \"extKey2\", \"value\": \"extValue2\"}\n        ] }\n      },\n       {\n        \"transferId\": \"{{transferId2}}\",\n        \"transferAmount\": {\n            \"currency\": \"{{currency2}}\",\n            \"amount\": \"{{amount2}}\"\n        },\n        \"ilpPacket\": \"{{validIlpPacket2}}\",\n        \"condition\": \"{{validCondition2}}\"\n    } ],\n    \"expiration\": \"{{expirationDate}}\"\n}"
						},
						"url": {
							"raw": "{{HOST_BULK_ADAPTER}}/bulkTransfers",
							"host": [
								"{{HOST_BULK_ADAPTER}}"
							],
							"path": [
								"bulkTransfers"
							]
						}
					},
					"response": []
				},
				{
					"name": "GET Bulk Transfer - PayeeFSP",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "050511e2-57aa-4fdd-94ad-484bce3ce949",
								"exec": [
									"pm.environment.set(\"acceptHeader\", \"application/vnd.interoperability.bulkTransfers+json;version=1\");",
									"pm.environment.set(\"contentType\", \"application/vnd.interoperability.bulkTransfers+json;version=1.0\");"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "384c9d2d-4000-4b63-8aa9-079a8478367d",
								"exec": [
									"pm.test(\"Status code is 202\", function () {",
									"    pm.response.to.have.status(202);",
									"});",
									"",
									"setTimeout(function () {",
									"  pm.sendRequest(pm.environment.get(\"PAYEEFSP_SDK_TESTAPI_URL\")+\"/callbacks/\"+pm.environment.get(\"bulkTransferId\"), function (err, response) {",
									"          if(response.responseSize !== 0) {",
									"              const jsonResponse = response.json();",
									"              ",
									"              const headers = jsonResponse.headers",
									"              pm.test(\"date header should be set\", function () {",
									"                pm.expect(headers.date).to.be.ok;",
									"              });",
									"              pm.test(\"fspiop-source should be switch\", function () {",
									"                pm.expect(headers[\"fspiop-source\"]).to.eql('switch');",
									"              });",
									"              pm.test(\"fspiop-destination should be payeefsp\", function () {",
									"                pm.expect(headers[\"fspiop-destination\"]).to.eql('payeefsp');",
									"              });",
									"              pm.test(\"fspiop-http-method should be PUT\", function () {",
									"                pm.expect(headers[\"fspiop-http-method\"]).to.eql('PUT');",
									"              });",
									"              pm.test(\"fspiop-uri should be /payeefsp/bulkTransfers/\" + pm.environment.get(\"bulkTransferId\"), function () {",
									"                pm.expect(headers[\"fspiop-uri\"]).to.eql(\"/payeefsp/bulkTransfers/\" + pm.environment.get(\"bulkTransferId\"));",
									"              });",
									"              pm.test(\"fspiop-signature should not be set\", function () {",
									"                pm.expect(headers[\"fspiop-signature\"]).to.eql(undefined);",
									"              });",
									"              ",
									"             ",
									"              const data = jsonResponse.data",
									"              pm.test(\"Bulk Transfer state should be COMPLETED on Payee side\", function () {",
									"                pm.expect(data.bulkTransferState).to.eql('COMPLETED');",
									"              });",
									"              pm.test(\"Completed timestamp should be set\", function () {",
									"                pm.expect(data.completedTimestamp).to.be.ok;",
									"              });",
									"              pm.test(\"All individual transfer results (fulfilments) should be returned\", function () {",
									"                pm.expect(data.individualTransferResults.length).to.eql(2);",
									"              });",
									"              const transfer1 = data.individualTransferResults.find(t => t.transferId === pm.environment.get(\"transferId\"));",
									"              pm.test(\"1st individual transfer should have fulfilment\", function () {",
									"                  pm.expect(transfer1.fulfilment).to.be.ok",
									"              });",
									"              const transfer2 = data.individualTransferResults.find(t => t.transferId === pm.environment.get(\"transferId2\"));",
									"              pm.test(\"2nd individual transfer should have fulfilment\", function () {",
									"                  pm.expect(transfer2.fulfilment).to.be.ok",
									"              });",
									"          } else {",
									"              pm.test(\"Transfer FAILED\", function () {",
									"                throw new Error('Did not receive response');",
									"              });",
									"          }",
									"   });",
									"}, 1000)",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"name": "Content-Type",
								"type": "text",
								"value": "{{contentType}}"
							},
							{
								"key": "Date",
								"value": "{{headerDate}}"
							},
							{
								"key": "Accept",
								"value": "{{acceptHeader}}"
							},
							{
								"key": "FSPIOP-Source",
								"value": "{{payeefsp}}"
							},
							{
								"key": "FSPIOP-Destination",
								"value": "switch"
							},
							{
								"key": "FSPIOP-Signature",
								"type": "text",
								"value": "~~{{payeefsp}}~~"
							},
							{
								"key": "FSPIOP-URI",
								"type": "text",
								"value": "/bulkTransfers/{{bulkTransferId}}"
							},
							{
								"key": "FSPIOP-HTTP-Method",
								"type": "text",
								"value": "GET"
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{HOST_BULK_ADAPTER}}/bulkTransfers/{{bulkTransferId}}",
							"host": [
								"{{HOST_BULK_ADAPTER}}"
							],
							"path": [
								"bulkTransfers",
								"{{bulkTransferId}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "GET Bulk Transfer - PayerFSP",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "62f9d290-b584-43a5-a653-d8717843b2c4",
								"exec": [
									"pm.environment.set(\"acceptHeader\", \"application/vnd.interoperability.bulkTransfers+json;version=1\");",
									"pm.environment.set(\"contentType\", \"application/vnd.interoperability.bulkTransfers+json;version=1.0\");"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "ca44b1e3-554d-4178-b30d-24bb611c32da",
								"exec": [
									"pm.test(\"Status code is 202\", function () {",
									"    pm.response.to.have.status(202);",
									"});",
									"",
									"setTimeout(function () {",
									"  pm.sendRequest(pm.environment.get(\"PAYERFSP_SDK_TESTAPI_URL\")+\"/callbacks/\"+pm.environment.get(\"bulkTransferId\"), function (err, response) {",
									"          if(response.responseSize !== 0) {",
									"              const jsonResponse = response.json();",
									"              ",
									"              const headers = jsonResponse.headers",
									"              pm.test(\"date header should be set\", function () {",
									"                pm.expect(headers.date).to.be.ok;",
									"              });",
									"              pm.test(\"fspiop-source should be switch\", function () {",
									"                pm.expect(headers[\"fspiop-source\"]).to.eql('switch');",
									"              });",
									"              pm.test(\"fspiop-destination should be payerfsp\", function () {",
									"                pm.expect(headers[\"fspiop-destination\"]).to.eql('payerfsp');",
									"              });",
									"              pm.test(\"fspiop-http-method should be PUT\", function () {",
									"                pm.expect(headers[\"fspiop-http-method\"]).to.eql('PUT');",
									"              });",
									"              pm.test(\"fspiop-uri should be /payerfsp/bulkTransfers/\" + pm.environment.get(\"bulkTransferId\"), function () {",
									"                pm.expect(headers[\"fspiop-uri\"]).to.eql(\"/payerfsp/bulkTransfers/\" + pm.environment.get(\"bulkTransferId\"));",
									"              });",
									"              pm.test(\"fspiop-signature should not be set\", function () {",
									"                pm.expect(headers[\"fspiop-signature\"]).to.eql(undefined)",
									"              });",
									"              ",
									"              const data = jsonResponse.data",
									"              pm.test(\"Bulk Transfer state should be COMPLETED on Payer side\", function () {",
									"                pm.expect(data.bulkTransferState).to.eql('COMPLETED');",
									"              });",
									"              pm.test(\"Completed timestamp should be set\", function () {",
									"                pm.expect(data.completedTimestamp).to.be.ok;",
									"              });",
									"              pm.test(\"All individual transfer results (fulfilments) should be returned\", function () {",
									"                pm.expect(data.individualTransferResults.length).to.eql(2);",
									"              });",
									"              const transfer1 = data.individualTransferResults.find(t => t.transferId === pm.environment.get(\"transferId\"));",
									"              pm.test(\"1st individual transfer should have fulfilment\", function () {",
									"                  pm.expect(transfer1.fulfilment).to.be.ok",
									"              });",
									"              const transfer2 = data.individualTransferResults.find(t => t.transferId === pm.environment.get(\"transferId2\"));",
									"              pm.test(\"2nd individual transfer should have fulfilment\", function () {",
									"                  pm.expect(transfer2.fulfilment).to.be.ok",
									"              });",
									"          } else {",
									"              pm.test(\"Transfer FAILED\", function () {",
									"                throw new Error('Did not receive response');",
									"              });",
									"              ",
									"          }",
									"   });",
									"}, 1000)"
								],
								"type": "text/javascript"
							}
						}
					],
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"name": "Content-Type",
								"type": "text",
								"value": "{{contentType}}"
							},
							{
								"key": "Date",
								"value": "{{headerDate}}"
							},
							{
								"key": "Accept",
								"value": "{{acceptHeader}}"
							},
							{
								"key": "FSPIOP-Source",
								"value": "{{payerfsp}}"
							},
							{
								"key": "FSPIOP-Destination",
								"value": "switch"
							},
							{
								"key": "FSPIOP-Signature",
								"type": "text",
								"value": "~~{{payerfsp}}~~"
							},
							{
								"key": "FSPIOP-URI",
								"type": "text",
								"value": "/bulkTransfers/{{bulkTransferId}}"
							},
							{
								"key": "FSPIOP-HTTP-Method",
								"type": "text",
								"value": "GET"
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{HOST_BULK_ADAPTER}}/bulkTransfers/{{bulkTransferId}}",
							"host": [
								"{{HOST_BULK_ADAPTER}}"
							],
							"path": [
								"bulkTransfers",
								"{{bulkTransferId}}"
							]
						}
					},
					"response": []
				}
			],
			"protocolProfileBehavior": {}
		},
		{
			"name": "Negative Scenarios",
			"item": [
				{
					"name": "payee_abort",
					"item": [
						{
							"name": "Store Payerfsp position before prepare",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "e29a4211-8c19-4271-afd1-72deafc0b9e1",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"});",
											"",
											"var jsonData = pm.response.json();",
											"",
											"pm.environment.set(\"payerfspPositionBeforePrepare\", jsonData[0].value);",
											"",
											"",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"id": "47303550-3485-40c3-93dd-df8927ae0c3a",
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{BEARER_TOKEN}}",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [
									{
										"key": "FSPIOP-Source",
										"type": "text",
										"value": "{{payerfsp}}"
									}
								],
								"url": {
									"raw": "{{HOST_CENTRAL_LEDGER}}{{BASE_CENTRAL_LEDGER_ADMIN}}/participants/{{payerfsp}}/positions",
									"host": [
										"{{HOST_CENTRAL_LEDGER}}{{BASE_CENTRAL_LEDGER_ADMIN}}"
									],
									"path": [
										"participants",
										"{{payerfsp}}",
										"positions"
									]
								}
							},
							"response": []
						},
						{
							"name": "Store Payeefsp position before prepare",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "ce87ec90-9d2d-4e67-bd92-9762ca723183",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"});",
											"",
											"var jsonData = pm.response.json();",
											"",
											"pm.environment.set(\"payeefspPositionBeforePrepare\", jsonData[0].value);",
											"",
											"",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"id": "ce7b493d-6544-42cd-afd6-2df96123edd5",
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{BEARER_TOKEN}}",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [
									{
										"key": "FSPIOP-Source",
										"type": "text",
										"value": "noresponsepayeefsp"
									}
								],
								"url": {
									"raw": "{{HOST_CENTRAL_LEDGER}}{{BASE_CENTRAL_LEDGER_ADMIN}}/participants/noresponsepayeefsp/positions",
									"host": [
										"{{HOST_CENTRAL_LEDGER}}{{BASE_CENTRAL_LEDGER_ADMIN}}"
									],
									"path": [
										"participants",
										"noresponsepayeefsp",
										"positions"
									]
								}
							},
							"response": []
						},
						{
							"name": "Send Prepare",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "b8cebd41-e52f-4a08-abc2-f862f9430762",
										"exec": [
											"const uuid = require('uuid');",
											"",
											"const delay = 1000 * 3600 * 24",
											"const bulkTransferId = uuid.v4();",
											"const bulkQuoteId = uuid.v4();",
											"const transferId = uuid.v4();",
											"const transferId2 = uuid.v4();",
											"const now = new Date();",
											"const headerDate = now.toUTCString();",
											"const expirationDate = new Date(now.getTime() + delay).toISOString();",
											"const completedTimestamp = now.toISOString();",
											"const amount = 1;",
											"const amount2 = 2;",
											"",
											"pm.environment.set(\"bulkTransferId\", bulkTransferId);",
											"pm.environment.set(\"bulkQuoteId\", bulkQuoteId);",
											"pm.environment.set(\"transferId\", transferId);",
											"pm.environment.set(\"transferId2\", transferId2);",
											"pm.environment.set(\"headerDate\", headerDate);",
											"pm.environment.set(\"expirationDate\", expirationDate);",
											"pm.environment.set(\"completedTimestamp\", completedTimestamp);",
											"pm.environment.set(\"amount\", amount);",
											"pm.environment.set(\"amount2\", amount2);",
											"pm.environment.set(\"currency2\", \"USD\");",
											"pm.environment.set(\"acceptHeader\", \"application/vnd.interoperability.bulkTransfers+json;version=1\");",
											"pm.environment.set(\"contentType\", \"application/vnd.interoperability.bulkTransfers+json;version=1.0\");",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "6adb333f-031b-473c-a395-1bd8e59662e0",
										"exec": [
											"pm.test(\"Status code is 202\", function () {",
											"    pm.response.to.have.status(202);",
											"});",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{BEARER_TOKEN}}",
											"type": "string"
										}
									]
								},
								"method": "POST",
								"header": [
									{
										"key": "Accept",
										"value": "{{acceptHeader}}"
									},
									{
										"key": "Content-Type",
										"value": "{{contentType}}"
									},
									{
										"key": "Date",
										"value": "{{dateHeader}}"
									},
									{
										"key": "FSPIOP-Source",
										"value": "{{payerfsp}}"
									},
									{
										"key": "FSPIOP-Destination",
										"value": "noresponsepayeefsp"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{ \n    \"bulkTransferId\": \"{{bulkTransferId}}\",\n    \"bulkQuoteId\": \"{{bulkQuoteId}}\",\n    \"payeeFsp\": \"noresponsepayeefsp\",\n    \"payerFsp\": \"{{payerfsp}}\",\n    \"individualTransfers\":\n    [ {\n        \"transferId\": \"{{transferId}}\",\n        \"transferAmount\": {\n            \"currency\": \"{{currency}}\",\n            \"amount\": \"{{amount}}\"\n        },\n        \"ilpPacket\": \"{{validIlpPacket2}}\",\n        \"condition\": \"{{validCondition2}}\",\n        \"extensionList\": { \"extension\": [\n            { \"key\": \"extKey1\", \"value\": \"extValue1\"},\n            { \"key\": \"extKey2\", \"value\": \"extValue2\"}\n        ] }\n      },\n      {\n        \"transferId\": \"{{transferId2}}\",\n        \"transferAmount\": {\n            \"currency\": \"{{currency2}}\",\n            \"amount\": \"{{amount2}}\"\n        },\n        \"ilpPacket\": \"{{validIlpPacket2}}\",\n        \"condition\": \"{{validCondition2}}\"\n    } ],\n    \"expiration\": \"{{expirationDate}}\"\n}",
									"options": {
										"raw": {}
									}
								},
								"url": {
									"raw": "{{HOST_BULK_ADAPTER}}/bulkTransfers",
									"host": [
										"{{HOST_BULK_ADAPTER}}"
									],
									"path": [
										"bulkTransfers"
									]
								}
							},
							"response": []
						},
						{
							"name": "Store Payerfsp position after Prepare",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "25163402-6ba2-455a-88d3-36a9cc10d27f",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"});",
											"",
											"var jsonData = pm.response.json();",
											"",
											"pm.environment.set(\"payerfspPositionAfterPrepare\", jsonData[0].value);",
											"",
											"",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"id": "04e1ca32-5311-4fe2-8ce3-7b45cffc76a5",
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{BEARER_TOKEN}}",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [
									{
										"key": "FSPIOP-Source",
										"type": "text",
										"value": "{{payerfsp}}"
									}
								],
								"url": {
									"raw": "{{HOST_CENTRAL_LEDGER}}{{BASE_CENTRAL_LEDGER_ADMIN}}/participants/{{payerfsp}}/positions",
									"host": [
										"{{HOST_CENTRAL_LEDGER}}{{BASE_CENTRAL_LEDGER_ADMIN}}"
									],
									"path": [
										"participants",
										"{{payerfsp}}",
										"positions"
									]
								}
							},
							"response": []
						},
						{
							"name": "Send Payee Error",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "5fd13acb-7e04-436a-9208-27cd3718b97a",
										"exec": [
											"pm.environment.set(\"contentType\", \"application/vnd.interoperability.bulkTransfers+json;version=1.0\");",
											"pm.environment.set(\"acceptHeader\", \"application/vnd.interoperability.bulkTransfers+json;version=1\");"
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "be251cba-ae0b-40b6-afc6-d0fa75b02cdf",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"  pm.response.to.have.status(200);",
											"});",
											"",
											"setTimeout(function () {",
											"  pm.sendRequest(pm.environment.get(\"PAYERFSP_SDK_TESTAPI_URL\") + \"/callbacks/\" + pm.environment.get(\"bulkTransferId\"), function (err, response) {",
											"    if (response.responseSize !== 0) {",
											"      const jsonResponse = response.json();",
											"",
											"      const headers = jsonResponse.headers",
											"      pm.test(\"date header should be set\", function () {",
											"        pm.expect(headers.date).to.be.ok;",
											"      });",
											"      pm.test(\"fspiop-source should be noresponsepayeefsp\", function () {",
											"        pm.expect(headers[\"fspiop-source\"]).to.eql('noresponsepayeefsp');",
											"      });",
											"      pm.test(\"fspiop-destination should be payerfsp\", function () {",
											"        pm.expect(headers[\"fspiop-destination\"]).to.eql('payerfsp');",
											"      });",
											"      pm.test(\"fspiop-http-method should be PUT\", function () {",
											"        pm.expect(headers[\"fspiop-http-method\"]).to.eql('PUT');",
											"      });",
											"      pm.test(`fspiop-uri should be /payerfsp/bulkTransfers/${pm.environment.get('bulkTransferId')}/error`, function () {",
											"        pm.expect(headers[\"fspiop-uri\"]).to.eql(`/payerfsp/bulkTransfers/${pm.environment.get('bulkTransferId')}/error`);",
											"      });",
											"      pm.test(\"accept header should be undefined\", function () {",
											"        pm.expect(headers[\"accept\"]).to.eql(undefined);",
											"      });",
											"      pm.test(\"fspiop-signature should not be set\", function () {",
											"        pm.expect(headers[\"fspiop-signature\"]).to.eql(undefined);",
											"      });",
											"",
											"      const data = jsonResponse.data",
											"      pm.test('errorInformation should be set correctly', function () {",
											"        pm.expect(data).to.eql({",
											"          errorInformation: {",
											"            errorCode: \"5100\",",
											"            errorDescription: \"An error occured\"",
											"          }",
											"        })",
											"      });",
											"    } else {",
											"      pm.test(\"Transfer FAILED\", function () {",
											"        throw new Error('Did not receive response');",
											"      });",
											"",
											"    }",
											"  });",
											"",
											"  pm.sendRequest(pm.environment.get(\"HOST_LEGACY_SIMULATOR\") + \"/bulkTransfersNegative/callbacks/\" + pm.environment.get(\"bulkTransferId\"), function (err, response) {",
											"    if (response.responseSize !== 0) {",
											"      const jsonResponse = response.json();",
											"",
											"      const headers = jsonResponse.headers",
											"      pm.test(\"date header should be set\", function () {",
											"        pm.expect(headers.date).to.be.ok;",
											"      });",
											"      pm.test(\"fspiop-source should be switch\", function () {",
											"        pm.expect(headers[\"fspiop-source\"]).to.eql('switch');",
											"      });",
											"      pm.test(\"fspiop-destination should be noresponsepayeefsp\", function () {",
											"        pm.expect(headers[\"fspiop-destination\"]).to.eql('noresponsepayeefsp');",
											"      });",
											"      pm.test(\"fspiop-http-method should be PUT\", function () {",
											"        pm.expect(headers[\"fspiop-http-method\"]).to.eql('PUT');",
											"      });",
											"      pm.test(`fspiop-uri should be /noresponsepayeefsp/bulkTransfers/${pm.environment.get('bulkTransferId')}/error`, function () {",
											"        pm.expect(headers[\"fspiop-uri\"]).to.eql(`/noresponsepayeefsp/bulkTransfers/${pm.environment.get('bulkTransferId')}/error`);",
											"      });",
											"      pm.test(\"accept header should be undefined\", function () {",
											"        pm.expect(headers[\"accept\"]).to.eql(undefined);",
											"      });",
											"      pm.test(\"fspiop-signature should not be set\", function () {",
											"        pm.expect(headers[\"fspiop-signature\"]).to.eql(undefined);",
											"      });",
											"",
											"      const data = jsonResponse.data",
											"      pm.test('Request body should be errorInformation', function () {",
											"        pm.expect(data).to.eql({",
											"          errorInformation: {",
											"            errorCode: \"5100\",",
											"            errorDescription: \"An error occured\"",
											"          }",
											"        })",
											"      })",
											"    } else {",
											"      pm.test(\"Transfer FAILED\", function () {",
											"        throw new Error('Did not receive response');",
											"      });",
											"    }",
											"  });",
											"",
											"  pm.sendRequest(pm.environment.get(\"HOST_LEGACY_SIMULATOR\") + \"/bulkTransfersNegative/requests/\" + pm.environment.get(\"bulkTransferId\"), function (err, response) {",
											"    if (response.responseSize !== 0) {",
											"      const jsonResponse = response.json();",
											"",
											"      const headers = jsonResponse.headers",
											"      pm.test(\"date header should be set\", function () {",
											"        pm.expect(headers.date).to.be.ok;",
											"      });",
											"      pm.test(\"fspiop-source should be payerfsp\", function () {",
											"        pm.expect(headers[\"fspiop-source\"]).to.eql('payerfsp');",
											"      });",
											"      pm.test(\"fspiop-destination should be noresponsepayeefsp\", function () {",
											"        pm.expect(headers[\"fspiop-destination\"]).to.eql('noresponsepayeefsp');",
											"      });",
											"      pm.test(\"fspiop-http-method should be POST\", function () {",
											"        pm.expect(headers[\"fspiop-http-method\"]).to.eql('POST');",
											"      });",
											"      pm.test(\"fspiop-uri should be /bulkTransfers\", function () {",
											"        pm.expect(headers[\"fspiop-uri\"]).to.eql(\"/bulkTransfers\");",
											"      });",
											"      pm.test(\"accept header should be application/vnd.interoperability.bulkTransfers+json;version=1\", function () {",
											"        pm.expect(headers[\"accept\"]).to.eql(\"application/vnd.interoperability.bulkTransfers+json;version=1\");",
											"      });",
											"      pm.test(\"fspiop-signature should not be set\", function () {",
											"        pm.expect(headers[\"fspiop-signature\"]).to.eql(undefined);",
											"      });",
											"",
											"      const data = jsonResponse.data",
											"      pm.test('Request body should be sent correctly', function () {",
											"        pm.expect(data).to.have.property(\"bulkTransferId\", pm.environment.get(\"bulkTransferId\"));",
											"        pm.expect(data).to.have.property(\"bulkQuoteId\", pm.environment.get(\"bulkQuoteId\"));",
											"        pm.expect(data).to.have.property(\"payeeFsp\",\"noresponsepayeefsp\");",
											"        pm.expect(data).to.have.property(\"payerFsp\", pm.environment.get(\"payerfsp\"));",
											"        pm.expect(data.individualTransfers.length).to.eql(2);",
											"",
											"        const transfer1 = data.individualTransfers.find(t => t.extensionList !== undefined )",
											"        pm.expect(transfer1).to.have.property(\"transferId\", pm.environment.get(\"transferId\"))",
											"        pm.expect(JSON.stringify(transfer1.transferAmount)).to.eql(JSON.stringify({ amount: \"1\", currency: \"USD\" }))",
											"        pm.expect(transfer1).to.have.property(\"ilpPacket\", pm.environment.get(\"validIlpPacket2\"))",
											"        pm.expect(transfer1).to.have.property(\"condition\", pm.environment.get(\"validCondition2\"))",
											"        pm.expect(JSON.stringify(transfer1.extensionList)).to.eql(JSON.stringify({ extension: [{key: \"extKey1\", value: \"extValue1\"}, { key: \"extKey2\", value: \"extValue2\" }]}))",
											"",
											"        const transfer2 = data.individualTransfers.find(t => t.extensionList === undefined )",
											"        pm.expect(transfer2).to.have.property(\"transferId\", pm.environment.get(\"transferId2\"))",
											"        pm.expect(JSON.stringify(transfer2.transferAmount)).to.eql(JSON.stringify({ amount: \"2\", currency: \"USD\" }))",
											"        pm.expect(transfer2).to.have.property(\"ilpPacket\", pm.environment.get(\"validIlpPacket2\"))",
											"        pm.expect(transfer2).to.have.property(\"condition\", pm.environment.get(\"validCondition2\"))",
											"      })",
											"    } else {",
											"      pm.test(\"Transfer FAILED\", function () {",
											"        throw new Error('Did not receive response');",
											"      });",
											"    }",
											"  });",
											"}, 1000)"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{PAYEEFSP_BEARER_TOKEN}}",
											"type": "string"
										}
									]
								},
								"method": "PUT",
								"header": [
									{
										"key": "Content-Type",
										"name": "Content-Type",
										"type": "text",
										"value": "{{contentType}}"
									},
									{
										"key": "Date",
										"type": "text",
										"value": "{{dateHeader}}"
									},
									{
										"key": "FSPIOP-Source",
										"type": "text",
										"value": "noresponsepayeefsp"
									},
									{
										"key": "FSPIOP-Destination",
										"type": "text",
										"value": "{{payerfsp}}"
									},
									{
										"key": "Accept",
										"value": "{{acceptHeader}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{ \n    \"errorInformation\": {\n        \"errorCode\": \"5100\",\n        \"errorDescription\": \"An error occured\"\n    }\n}",
									"options": {
										"raw": {}
									}
								},
								"url": {
									"raw": "{{HOST_BULK_ADAPTER}}/bulkTransfers/{{bulkTransferId}}/error",
									"host": [
										"{{HOST_BULK_ADAPTER}}"
									],
									"path": [
										"bulkTransfers",
										"{{bulkTransferId}}",
										"error"
									]
								}
							},
							"response": []
						},
						{
							"name": "GET Bulk Transfer - PayerFSP",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "fd4b6fe4-3608-4788-99fa-afcbaacc37d7",
										"exec": [
											"pm.environment.set(\"acceptHeader\", \"application/vnd.interoperability.bulkTransfers+json;version=1\");",
											"pm.environment.set(\"contentType\", \"application/vnd.interoperability.bulkTransfers+json;version=1.0\");"
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "0d79695f-d615-4c81-957e-e0a8e892b447",
										"exec": [
											"pm.test(\"Status code is 202\", function () {",
											"  pm.response.to.have.status(202);",
											"});",
											"",
											"setTimeout(function () {",
											"  pm.sendRequest(pm.environment.get(\"PAYERFSP_SDK_TESTAPI_URL\") + \"/callbacks/\" + pm.environment.get(\"bulkTransferId\"), function (err, response) {",
											"    if (response.responseSize !== 0) {",
											"      const jsonResponse = response.json();",
											"",
											"      const headers = jsonResponse.headers",
											"      pm.test(\"date header should be set\", function () {",
											"        pm.expect(headers.date).to.be.ok;",
											"      });",
											"      pm.test(\"fspiop-source should be switch\", function () {",
											"        pm.expect(headers[\"fspiop-source\"]).to.eql('switch');",
											"      });",
											"      pm.test(\"fspiop-destination should be payerfsp\", function () {",
											"        pm.expect(headers[\"fspiop-destination\"]).to.eql('payerfsp');",
											"      });",
											"      pm.test(\"fspiop-http-method should be PUT\", function () {",
											"        pm.expect(headers[\"fspiop-http-method\"]).to.eql('PUT');",
											"      });",
											"      pm.test(`fspiop-uri should be /payerfsp/bulkTransfers/${pm.environment.get(\"bulkTransferId\")}/error`, function () {",
											"        pm.expect(headers[\"fspiop-uri\"]).to.eql(`/payerfsp/bulkTransfers/${pm.environment.get(\"bulkTransferId\")}/error`);",
											"      });",
											"      pm.test(\"fspiop-signature should not be set\", function () {",
											"        pm.expect(headers[\"fspiop-signature\"]).to.eql(undefined);",
											"      });",
											"",
											"      const data = jsonResponse.data",
											"      pm.test('errorInformation should be set correctly', function () {",
											"        pm.expect(data).to.eql({",
											"          errorInformation: {",
											"            errorCode: \"5100\",",
											"            errorDescription: \"An error occured\"",
											"          }",
											"        })",
											"      });",
											"    } else {",
											"      pm.test(\"Transfer FAILED\", function () {",
											"        throw new Error('Did not receive response');",
											"      });",
											"    }",
											"  });",
											"}, 1000)",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Content-Type",
										"name": "Content-Type",
										"type": "text",
										"value": "{{contentType}}"
									},
									{
										"key": "Date",
										"value": "{{headerDate}}"
									},
									{
										"key": "Accept",
										"value": "{{acceptHeader}}"
									},
									{
										"key": "FSPIOP-Source",
										"value": "{{payerfsp}}"
									},
									{
										"key": "FSPIOP-Destination",
										"value": "switch"
									},
									{
										"key": "FSPIOP-Signature",
										"type": "text",
										"value": "~~{{payerfsp}}~~"
									},
									{
										"key": "FSPIOP-URI",
										"type": "text",
										"value": "/bulkTransfers/{{bulkTransferId}}"
									},
									{
										"key": "FSPIOP-HTTP-Method",
										"type": "text",
										"value": "GET"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "{{HOST_BULK_ADAPTER}}/bulkTransfers/{{bulkTransferId}}",
									"host": [
										"{{HOST_BULK_ADAPTER}}"
									],
									"path": [
										"bulkTransfers",
										"{{bulkTransferId}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "GET Bulk Transfer - PayeeFSP",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "477d3da3-443a-4b1d-9076-caa5d920b6c0",
										"exec": [
											"pm.environment.set(\"acceptHeader\", \"application/vnd.interoperability.bulkTransfers+json;version=1\");",
											"pm.environment.set(\"contentType\", \"application/vnd.interoperability.bulkTransfers+json;version=1.0\");"
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "c8343f12-dfa2-4514-9f2d-1e7ff7ad6530",
										"exec": [
											"pm.test(\"Status code is 202\", function () {",
											"    pm.response.to.have.status(202);",
											"});",
											"",
											"setTimeout(function () {",
											"   pm.sendRequest(pm.environment.get(\"HOST_LEGACY_SIMULATOR\") + \"/bulkTransfersNegative/callbacks/\" + pm.environment.get(\"bulkTransferId\"), function (err, response) {",
											"    if (response.responseSize !== 0) {",
											"      const jsonResponse = response.json();",
											"",
											"      const headers = jsonResponse.headers",
											"      pm.test(\"date header should be set\", function () {",
											"        pm.expect(headers.date).to.be.ok;",
											"      });",
											"      pm.test(\"fspiop-source should be switch\", function () {",
											"        pm.expect(headers[\"fspiop-source\"]).to.eql('switch');",
											"      });",
											"      pm.test(\"fspiop-destination should be noresponsepayeefsp\", function () {",
											"        pm.expect(headers[\"fspiop-destination\"]).to.eql('noresponsepayeefsp');",
											"      });",
											"      pm.test(\"fspiop-http-method should be PUT\", function () {",
											"        pm.expect(headers[\"fspiop-http-method\"]).to.eql('PUT');",
											"      });",
											"      pm.test(`fspiop-uri should be /noresponsepayeefsp/bulkTransfers/${pm.environment.get('bulkTransferId')}/error`, function () {",
											"        pm.expect(headers[\"fspiop-uri\"]).to.eql(`/noresponsepayeefsp/bulkTransfers/${pm.environment.get('bulkTransferId')}/error`);",
											"      });",
											"      pm.test(\"accept header should be undefined\", function () {",
											"        pm.expect(headers[\"accept\"]).to.eql(undefined);",
											"      });",
											"      pm.test(\"fspiop-signature should not be set\", function () {",
											"        pm.expect(headers[\"fspiop-signature\"]).to.eql(undefined);",
											"      });",
											"",
											"      const data = jsonResponse.data",
											"      pm.test('Request body should be errorInformation', function () {",
											"        pm.expect(data).to.eql({",
											"          errorInformation: {",
											"            errorCode: \"5100\",",
											"            errorDescription: \"An error occured\"",
											"          }",
											"        })",
											"      })",
											"    } else {",
											"      pm.test(\"Transfer FAILED\", function () {",
											"        throw new Error('Did not receive response');",
											"      });",
											"    }",
											"  });",
											"}, 1000)",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Content-Type",
										"name": "Content-Type",
										"type": "text",
										"value": "{{contentType}}"
									},
									{
										"key": "Date",
										"value": "{{headerDate}}"
									},
									{
										"key": "Accept",
										"value": "{{acceptHeader}}"
									},
									{
										"key": "FSPIOP-Source",
										"value": "noresponsepayeefsp"
									},
									{
										"key": "FSPIOP-Destination",
										"value": "switch"
									},
									{
										"key": "FSPIOP-Signature",
										"type": "text",
										"value": "~~noresponsepayeefsp~~"
									},
									{
										"key": "FSPIOP-URI",
										"type": "text",
										"value": "/bulkTransfers/{{bulkTransferId}}"
									},
									{
										"key": "FSPIOP-HTTP-Method",
										"type": "text",
										"value": "GET"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "{{HOST_BULK_ADAPTER}}/bulkTransfers/{{bulkTransferId}}",
									"host": [
										"{{HOST_BULK_ADAPTER}}"
									],
									"path": [
										"bulkTransfers",
										"{{bulkTransferId}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Check Payerfsp position after Abort",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "61ec402f-3344-4154-be24-4779772a4d39",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"});",
											"",
											"var jsonData = pm.response.json();",
											"",
											"pm.test(\"Payerfsp position after Payee ABORT should be same as position before prepare.\", function () {",
											"    pm.expect(jsonData[0].value).to.equal(Number(pm.environment.get('payerfspPositionBeforePrepare')));",
											"});",
											"",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"id": "8c8837aa-bb6a-4218-85bf-2c70dc054d0d",
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{BEARER_TOKEN}}",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [
									{
										"key": "FSPIOP-Source",
										"type": "text",
										"value": "{{payerfsp}}"
									}
								],
								"url": {
									"raw": "{{HOST_CENTRAL_LEDGER}}{{BASE_CENTRAL_LEDGER_ADMIN}}/participants/{{payerfsp}}/positions",
									"host": [
										"{{HOST_CENTRAL_LEDGER}}{{BASE_CENTRAL_LEDGER_ADMIN}}"
									],
									"path": [
										"participants",
										"{{payerfsp}}",
										"positions"
									]
								}
							},
							"response": []
						},
						{
							"name": "Check Payeefsp position after Abort",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "809567a3-e059-4bb9-a898-50d4be36a828",
										"exec": [
											"pm.test(\"Status code is 200\", function () {",
											"    pm.response.to.have.status(200);",
											"});",
											"",
											"var jsonData = pm.response.json();",
											"",
											"pm.test(\"Payeefsp position after Payee ABORT should be same as position before prepare.\", function () {",
											"    pm.expect(jsonData[0].value).to.equal(Number(pm.environment.get('payeefspPositionBeforePrepare')));",
											"});",
											"",
											""
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"id": "0635d29a-6563-4b48-b601-9ea3fc2c6f88",
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "bearer",
									"bearer": [
										{
											"key": "token",
											"value": "{{BEARER_TOKEN}}",
											"type": "string"
										}
									]
								},
								"method": "GET",
								"header": [
									{
										"key": "FSPIOP-Source",
										"type": "text",
										"value": "{{payerfsp}}"
									}
								],
								"url": {
									"raw": "{{HOST_CENTRAL_LEDGER}}{{BASE_CENTRAL_LEDGER_ADMIN}}/participants/noresponsepayeefsp/positions",
									"host": [
										"{{HOST_CENTRAL_LEDGER}}{{BASE_CENTRAL_LEDGER_ADMIN}}"
									],
									"path": [
										"participants",
										"noresponsepayeefsp",
										"positions"
									]
								}
							},
							"response": []
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				},
				{
					"name": "partial fulfil",
					"item": [
						{
							"name": "POST Bulk Transfer",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "00c6b857-1070-47e4-9c6e-a3becc251d7e",
										"exec": [
											"const uuid = require('uuid');",
											"",
											"const delay = 1000 * 3600 * 24",
											"const bulkTransferId = uuid.v4();",
											"const bulkQuoteId = uuid.v4();",
											"const transferId = uuid.v4();",
											"const transferId2 = uuid.v4();",
											"const now = new Date();",
											"const headerDate = now.toUTCString();",
											"const expirationDate = new Date(now.getTime() + delay).toISOString();",
											"const completedTimestamp = now.toISOString();",
											"",
											"pm.environment.set(\"bulkTransferId\", bulkTransferId);",
											"pm.environment.set(\"bulkQuoteId\", bulkQuoteId);",
											"pm.environment.set(\"transferId\", transferId);",
											"pm.environment.set(\"transferId2\", transferId2);",
											"pm.environment.set(\"headerDate\", headerDate);",
											"pm.environment.set(\"expirationDate\", expirationDate);",
											"pm.environment.set(\"completedTimestamp\", completedTimestamp);",
											"pm.environment.set(\"amount\", 1);",
											"pm.environment.set(\"amount2\", 1);",
											"pm.environment.set(\"currency2\", \"USD\");",
											"pm.environment.set(\"acceptHeader\", \"application/vnd.interoperability.bulkTransfers+json;version=1\");",
											"pm.environment.set(\"contentType\", \"application/vnd.interoperability.bulkTransfers+json;version=1.0\");"
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "7343516f-cc0d-4f05-809d-322f45c5385a",
										"exec": [
											"pm.test(\"Status code is 202\", function () {",
											"    pm.response.to.have.status(202);",
											"});",
											"",
											"setTimeout(function () {",
											"    pm.sendRequest(pm.environment.get(\"PAYEEFSP_SDK_TESTAPI_URL\") + \"/requests/\" + pm.environment.get(\"bulkTransferId\"), function (err, response) {",
											"        if (response.responseSize !== 0) {",
											"            const jsonResponse = response.json();",
											"",
											"            const headers = jsonResponse.headers",
											"            pm.test(\"date header should be set\", function () {",
											"                pm.expect(headers.date).to.be.ok;",
											"            });",
											"            pm.test(\"fspiop-source should be payerfsp\", function () {",
											"                pm.expect(headers[\"fspiop-source\"]).to.eql('payerfsp');",
											"            });",
											"            pm.test(\"fspiop-destination should be payeefsp\", function () {",
											"                pm.expect(headers[\"fspiop-destination\"]).to.eql('payeefsp');",
											"            });",
											"            pm.test(\"fspiop-http-method should be POST\", function () {",
											"                pm.expect(headers[\"fspiop-http-method\"]).to.eql('POST');",
											"            });",
											"            pm.test(\"fspiop-uri should be /bulkTransfers\", function () {",
											"                pm.expect(headers[\"fspiop-uri\"]).to.eql(\"/bulkTransfers\");",
											"            });",
											"            pm.test(\"fspiop-signature should be set\", function () {",
											"                pm.expect(headers[\"fspiop-signature\"]).to.be.ok;",
											"            });",
											"",
											"",
											"            const data = jsonResponse.data",
											"            pm.test(\"Bulk transfer Id should be set\", function () {",
											"                pm.expect(data.bulkTransferId).to.eql(pm.environment.get(\"bulkTransferId\"));",
											"            });",
											"            pm.test(\"Bulk quote Id should be set\", function () {",
											"                pm.expect(data.bulkQuoteId).to.eql(pm.environment.get(\"bulkQuoteId\"));",
											"            });",
											"            pm.test(\"PayerFsp should be 'payerfsp'\", function () {",
											"                pm.expect(data.payerFsp).to.eql(\"payerfsp\");",
											"            });",
											"            pm.test(\"PayeeFsp should be 'payeefsp'\", function () {",
											"                pm.expect(data.payeeFsp).to.eql(\"payeefsp\");",
											"            });",
											"            pm.test(\"expiration should be set\", function () {",
											"                pm.expect(data.expiration).to.be.ok;",
											"            });",
											"            pm.test(\"Individual transfers (prepare) should be one (1)\", function () {",
											"                pm.expect(data.individualTransfers.length).to.eql(1);",
											"            });",
											"            pm.test(\"Individual transfer should have transferId\", function () {",
											"                pm.expect(data.individualTransfers[0].transferId).to.be.ok;",
											"            });",
											"            pm.test(\"Individual transfer should have ilpPacket\", function () {",
											"                pm.expect(data.individualTransfers[0].ilpPacket).to.be.ok;",
											"            });",
											"            pm.test(\"Individual transfer should have condition\", function () {",
											"                pm.expect(data.individualTransfers[0].condition).to.be.ok;",
											"            });",
											"        } else {",
											"            pm.test(\"Transfer FAILED\", function () {",
											"                throw new Error('Did not receive response');",
											"            });",
											"        }",
											"    });",
											"",
											"    pm.sendRequest(pm.environment.get(\"PAYEEFSP_SDK_TESTAPI_URL\") + \"/callbacks/\" + pm.environment.get(\"bulkTransferId\"), function (err, response) {",
											"        if (response.responseSize !== 0) {",
											"            const jsonResponse = response.json();",
											"",
											"            const headers = jsonResponse.headers",
											"            pm.test(\"date header should be set\", function () {",
											"                pm.expect(headers.date).to.be.ok;",
											"            });",
											"            pm.test(\"fspiop-source should be switch\", function () {",
											"                pm.expect(headers[\"fspiop-source\"]).to.eql('switch');",
											"            });",
											"            pm.test(\"fspiop-destination should be payeefsp\", function () {",
											"                pm.expect(headers[\"fspiop-destination\"]).to.eql('payeefsp');",
											"            });",
											"            pm.test(\"fspiop-http-method should be PUT\", function () {",
											"                pm.expect(headers[\"fspiop-http-method\"]).to.eql('PUT');",
											"            });",
											"            pm.test(\"fspiop-uri should be /payeefsp/bulkTransfers/\" + pm.environment.get(\"bulkTransferId\"), function () {",
											"                pm.expect(headers[\"fspiop-uri\"]).to.eql(\"/payeefsp/bulkTransfers/\" + pm.environment.get(\"bulkTransferId\"));",
											"            });",
											"            pm.test(\"fspiop-signature should not be set\", function () {",
											"                pm.expect(headers[\"fspiop-signature\"]).to.eql(undefined);",
											"            });",
											"",
											"",
											"            const data = jsonResponse.data",
											"            pm.test(\"Bulk Transfer state should be COMPLETED on Payee side\", function () {",
											"                pm.expect(data.bulkTransferState).to.eql('COMPLETED');",
											"            });",
											"            pm.test(\"Completed timestamp should be set\", function () {",
											"                pm.expect(data.completedTimestamp).to.be.ok;",
											"            });",
											"            pm.test(\"Only one (1) individual transfer result (fulfilments) should be returned\", function () {",
											"                pm.expect(data.individualTransferResults.length).to.eql(1);",
											"            });",
											"            pm.test(\"Individual transfer result should have transferId\", function () {",
											"                pm.expect(data.individualTransferResults[0].transferId).to.be.ok;",
											"            });",
											"            pm.test(\"Individual transfer result should have fulfilment\", function () {",
											"                pm.expect(data.individualTransferResults[0].fulfilment).to.be.ok;",
											"            });",
											"        } else {",
											"            pm.test(\"Transfer FAILED\", function () {",
											"                throw new Error('Did not receive response');",
											"            });",
											"        }",
											"    });",
											"",
											"    pm.sendRequest(pm.environment.get(\"PAYERFSP_SDK_TESTAPI_URL\") + \"/callbacks/\" + pm.environment.get(\"bulkTransferId\"), function (err, response) {",
											"        if (response.responseSize !== 0) {",
											"            const jsonResponse = response.json();",
											"",
											"            const headers = jsonResponse.headers",
											"            pm.test(\"date header should be set\", function () {",
											"                pm.expect(headers.date).to.be.ok;",
											"            });",
											"            pm.test(\"fspiop-source should be payeefsp\", function () {",
											"                pm.expect(headers[\"fspiop-source\"]).to.eql('payeefsp');",
											"            });",
											"            pm.test(\"fspiop-destination should be payerfsp\", function () {",
											"                pm.expect(headers[\"fspiop-destination\"]).to.eql('payerfsp');",
											"            });",
											"            pm.test(\"fspiop-http-method should be PUT\", function () {",
											"                pm.expect(headers[\"fspiop-http-method\"]).to.eql('PUT');",
											"            });",
											"            pm.test(\"fspiop-uri should be /payerfsp/bulkTransfers/\" + pm.environment.get(\"bulkTransferId\"), function () {",
											"                pm.expect(headers[\"fspiop-uri\"]).to.eql(\"/payerfsp/bulkTransfers/\" + pm.environment.get(\"bulkTransferId\"));",
											"            });",
											"            pm.test(\"fspiop-signature should be set\", function () {",
											"                pm.expect(headers[\"fspiop-signature\"]).to.be.ok;",
											"            });",
											"",
											"",
											"            const data = jsonResponse.data",
											"            pm.test(\"Bulk Transfer state should be COMPLETED on Payer side\", function () {",
											"                pm.expect(data.bulkTransferState).to.eql('COMPLETED');",
											"            });",
											"            pm.test(\"Completed timestamp should be set\", function () {",
											"                pm.expect(data.completedTimestamp).to.be.ok;",
											"            });",
											"            pm.test(\"All individual transfer results (failed & successful) should be returned\", function () {",
											"                pm.expect(data.individualTransferResults.length).to.eql(2);",
											"            });",
											"            pm.test(\"One individual transfer result should contain successful transfer fulfilment\", function () {",
											"                const successTransfer = data.individualTransferResults.find(t => t.transferId === pm.environment.get(\"transferId\"))",
											"                pm.expect(successTransfer.transferId).to.be.ok",
											"                pm.expect(successTransfer.fulfilment).to.be.ok",
											"            })",
											"            pm.test(\"One individual transfer result should contain errorInformation\", function () {",
											"                const failedTransfer = data.individualTransferResults.find(t => t.transferId === pm.environment.get(\"transferId2\"))",
											"                pm.expect(failedTransfer.errorInformation.errorCode).to.eql(\"3100\");",
											"                pm.expect(failedTransfer.errorInformation.errorDescription).to.eql(\"Generic validation error - Participant payerfsp AED account not found\");",
											"                pm.expect(failedTransfer.transferId).to.be.ok",
											"            })",
											"        } else {",
											"            pm.test(\"Transfer FAILED\", function () {",
											"                throw new Error('Did not receive response');",
											"            });",
											"        }",
											"    });",
											"}, 3000)"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"name": "Content-Type",
										"type": "text",
										"value": "{{contentType}}"
									},
									{
										"key": "Date",
										"value": "{{headerDate}}"
									},
									{
										"key": "Accept",
										"value": "{{acceptHeader}}"
									},
									{
										"key": "FSPIOP-Source",
										"value": "{{payerfsp}}"
									},
									{
										"key": "FSPIOP-Destination",
										"value": "{{payeefsp}}"
									},
									{
										"key": "FSPIOP-Signature",
										"type": "text",
										"value": "~~{{payerfsp}}~~"
									},
									{
										"key": "FSPIOP-URI",
										"type": "text",
										"value": "/bulkTransfers"
									},
									{
										"key": "FSPIOP-HTTP-Method",
										"value": "POST",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{ \n    \"bulkTransferId\": \"{{bulkTransferId}}\",\n    \"bulkQuoteId\": \"{{bulkQuoteId}}\",\n    \"payeeFsp\": \"{{payeefsp}}\",\n    \"payerFsp\": \"{{payerfsp}}\",\n    \"individualTransfers\":\n    [ {\n        \"transferId\": \"{{transferId}}\",\n        \"transferAmount\": {\n            \"currency\": \"{{currency}}\",\n            \"amount\": \"{{amount}}\"\n        },\n        \"ilpPacket\": \"{{validIlpPacket2}}\",\n        \"condition\": \"{{validCondition2}}\",\n        \"extensionList\": { \"extension\": [\n            { \"key\": \"extKey1\", \"value\": \"extValue1\"},\n            { \"key\": \"extKey2\", \"value\": \"extValue2\"}\n        ] }\n      },\n       {\n        \"transferId\": \"{{transferId2}}\",\n        \"transferAmount\": {\n            \"currency\": \"AED\",\n            \"amount\": \"{{amount2}}\"\n        },\n        \"ilpPacket\": \"{{validIlpPacket2}}\",\n        \"condition\": \"{{validCondition2}}\"\n    } ],\n    \"expiration\": \"{{expirationDate}}\"\n}"
								},
								"url": {
									"raw": "{{HOST_BULK_ADAPTER}}/bulkTransfers",
									"host": [
										"{{HOST_BULK_ADAPTER}}"
									],
									"path": [
										"bulkTransfers"
									]
								}
							},
							"response": []
						},
						{
							"name": "GET Bulk Transfer - PayeeFSP",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "2d13da76-6266-473c-b0b0-79bbd44aa5ee",
										"exec": [
											"pm.environment.set(\"contentType\", \"application/vnd.interoperability.bulkTransfers+json;version=1.0\");",
											"pm.environment.set(\"acceptHeader\", \"application/vnd.interoperability.bulkTransfers+json;version=1\");"
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "eff33f76-ee35-42b9-8872-e51d6762753d",
										"exec": [
											"pm.test(\"Status code is 202\", function () {",
											"    pm.response.to.have.status(202);",
											"});",
											"",
											"setTimeout(function () {",
											"  pm.sendRequest(pm.environment.get(\"PAYEEFSP_SDK_TESTAPI_URL\")+\"/callbacks/\"+pm.environment.get(\"bulkTransferId\"), function (err, response) {",
											"          if(response.responseSize !== 0) {",
											"              const jsonResponse = response.json();",
											"              ",
											"              const headers = jsonResponse.headers",
											"              pm.test(\"date header should be set\", function () {",
											"                pm.expect(headers.date).to.be.ok;",
											"              });",
											"              pm.test(\"fspiop-source should be switch\", function () {",
											"                pm.expect(headers[\"fspiop-source\"]).to.eql('switch');",
											"              });",
											"              pm.test(\"fspiop-destination should be payeefsp\", function () {",
											"                pm.expect(headers[\"fspiop-destination\"]).to.eql('payeefsp');",
											"              });",
											"              pm.test(\"fspiop-http-method should be PUT\", function () {",
											"                pm.expect(headers[\"fspiop-http-method\"]).to.eql('PUT');",
											"              });",
											"              pm.test(\"fspiop-uri should be /payeefsp/bulkTransfers/\" + pm.environment.get(\"bulkTransferId\"), function () {",
											"                pm.expect(headers[\"fspiop-uri\"]).to.eql(\"/payeefsp/bulkTransfers/\" + pm.environment.get(\"bulkTransferId\"));",
											"              });",
											"              pm.test(\"fspiop-signature should not be set\", function () {",
											"                pm.expect(headers[\"fspiop-signature\"]).to.eql(undefined);",
											"              });",
											"              ",
											"             ",
											"              const data = jsonResponse.data",
											"              pm.test(\"Bulk Transfer state should be COMPLETED on Payee side\", function () {",
											"                pm.expect(data.bulkTransferState).to.eql('COMPLETED');",
											"              });",
											"              pm.test(\"Completed timestamp should be set\", function () {",
											"                pm.expect(data.completedTimestamp).to.be.ok;",
											"              });",
											"              pm.test(\"Only one (1) individual transfer result (fulfilment) should be returned\", function () {",
											"                pm.expect(data.individualTransferResults.length).to.eql(1);",
											"              });",
											"              pm.test(\"Individual transfer result should have transferId\", function () {",
											"                pm.expect(data.individualTransferResults[0].transferId).to.be.ok;",
											"              });",
											"              pm.test(\"Individual transfer result should have fulfilment\", function () {",
											"                pm.expect(data.individualTransferResults[0].fulfilment).to.be.ok;",
											"              });",
											"          } else {",
											"              pm.test(\"Transfer FAILED\", function () {",
											"                throw new Error('Did not receive response');",
											"              });",
											"          }",
											"   });",
											"}, 1000)",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Content-Type",
										"name": "Content-Type",
										"type": "text",
										"value": "{{contentType}}"
									},
									{
										"key": "Date",
										"value": "{{headerDate}}"
									},
									{
										"key": "Accept",
										"value": "{{acceptHeader}}"
									},
									{
										"key": "FSPIOP-Source",
										"value": "{{payeefsp}}"
									},
									{
										"key": "FSPIOP-Destination",
										"value": "switch"
									},
									{
										"key": "FSPIOP-Signature",
										"type": "text",
										"value": "~~{{payeefsp}}~~"
									},
									{
										"key": "FSPIOP-URI",
										"type": "text",
										"value": "/bulkTransfers/{{bulkTransferId}}"
									},
									{
										"key": "FSPIOP-HTTP-Method",
										"type": "text",
										"value": "GET"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "{{HOST_BULK_ADAPTER}}/bulkTransfers/{{bulkTransferId}}",
									"host": [
										"{{HOST_BULK_ADAPTER}}"
									],
									"path": [
										"bulkTransfers",
										"{{bulkTransferId}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "GET Bulk Transfer - PayerFSP",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "02447c8c-6320-4341-ba65-c6f4a9f991d3",
										"exec": [
											"pm.environment.set(\"contentType\", \"application/vnd.interoperability.bulkTransfers+json;version=1.0\");",
											"pm.environment.set(\"acceptHeader\", \"application/vnd.interoperability.bulkTransfers+json;version=1\");"
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "955eb80a-5bb7-443e-b185-20379d937855",
										"exec": [
											"pm.test(\"Status code is 202\", function () {",
											"    pm.response.to.have.status(202);",
											"});",
											"",
											"setTimeout(function () {",
											"  pm.sendRequest(pm.environment.get(\"PAYERFSP_SDK_TESTAPI_URL\")+\"/callbacks/\"+pm.environment.get(\"bulkTransferId\"), function (err, response) {",
											"          if(response.responseSize !== 0) {",
											"              const jsonResponse = response.json();",
											"              ",
											"              const headers = jsonResponse.headers",
											"              pm.test(\"date header should be set\", function () {",
											"                pm.expect(headers.date).to.be.ok;",
											"              });",
											"              pm.test(\"fspiop-source should be switch\", function () {",
											"                pm.expect(headers[\"fspiop-source\"]).to.eql('switch');",
											"              });",
											"              pm.test(\"fspiop-destination should be payerfsp\", function () {",
											"                pm.expect(headers[\"fspiop-destination\"]).to.eql('payerfsp');",
											"              });",
											"              pm.test(\"fspiop-http-method should be PUT\", function () {",
											"                pm.expect(headers[\"fspiop-http-method\"]).to.eql('PUT');",
											"              });",
											"              pm.test(\"fspiop-uri should be /payerfsp/bulkTransfers/\" + pm.environment.get(\"bulkTransferId\"), function () {",
											"                pm.expect(headers[\"fspiop-uri\"]).to.eql(\"/payerfsp/bulkTransfers/\" + pm.environment.get(\"bulkTransferId\"));",
											"              });",
											"              pm.test(\"fspiop-signature should be set\", function () {",
											"                pm.expect(headers[\"fspiop-signature\"]).to.eql(undefined);",
											"              });",
											"              ",
											"             ",
											"              const data = jsonResponse.data",
											"              pm.test(\"Bulk transfer state should be COMPLETED on Payer side\", function () {",
											"                pm.expect(data.bulkTransferState).to.eql('COMPLETED');",
											"              });",
											"              pm.test(\"Completed timestamp should be set\", function () {",
											"                pm.expect(data.completedTimestamp).to.be.ok;",
											"              });",
											"              pm.test(\"All individual transfer results (fulfilments) should be returned\", function () {",
											"                pm.expect(data.individualTransferResults.length).to.eql(2);",
											"              });",
											"              const transfer1 = data.individualTransferResults.find(t => t.transferId === pm.environment.get(\"transferId\"));",
											"              pm.test(\"1st individual transfer should have fulfilment\", function () {",
											"                  pm.expect(transfer1.fulfilment).to.be.ok",
											"              });",
											"              const transfer2 = data.individualTransferResults.find(t => t.transferId === pm.environment.get(\"transferId2\"));",
											"              pm.test(\"2nd individual transfer should not have fulfilment\", function () {",
											"                  pm.expect(transfer2.fulfilment).to.eql(undefined)",
											"              });",
											"              pm.test(\"2nd individual transfer should contain valid error information\", function() {",
											"                pm.expect(transfer2.errorInformation.errorCode).to.eql(\"3100\");",
											"                pm.expect(transfer2.errorInformation.errorDescription).to.eql(\"Generic validation error - Participant payerfsp AED account not found\");",
											"              })",
											"          } else {",
											"              pm.test(\"Transfer FAILED\", function () {",
											"                throw new Error('Did not receive response');",
											"              });",
											"              ",
											"          }",
											"   });",
											"}, 1000)"
										],
										"type": "text/javascript"
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "Content-Type",
										"name": "Content-Type",
										"type": "text",
										"value": "{{contentType}}"
									},
									{
										"key": "Date",
										"value": "{{headerDate}}"
									},
									{
										"key": "Accept",
										"value": "{{acceptHeader}}"
									},
									{
										"key": "FSPIOP-Source",
										"value": "{{payerfsp}}"
									},
									{
										"key": "FSPIOP-Destination",
										"value": "switch"
									},
									{
										"key": "FSPIOP-Signature",
										"type": "text",
										"value": "~~{{payerfsp}}~~"
									},
									{
										"key": "FSPIOP-URI",
										"type": "text",
										"value": "/bulkTransfers/{{bulkTransferId}}"
									},
									{
										"key": "FSPIOP-HTTP-Method",
										"type": "text",
										"value": "GET"
									}
								],
								"body": {
									"mode": "raw",
									"raw": ""
								},
								"url": {
									"raw": "{{HOST_BULK_ADAPTER}}/bulkTransfers/{{bulkTransferId}}",
									"host": [
										"{{HOST_BULK_ADAPTER}}"
									],
									"path": [
										"bulkTransfers",
										"{{bulkTransferId}}"
									]
								}
							},
							"response": []
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				},
				{
					"name": "FSPIOP headers",
					"item": [
						{
							"name": "POST Bulk Transfer - Wrong Accept Header",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "38181271-78b9-4f84-a2a9-c3a27736ec80",
										"exec": [
											"const uuid = require('uuid');",
											"",
											"const delay = 1000 * 3600 * 24",
											"const bulkTransferId = uuid.v4();",
											"const bulkQuoteId = uuid.v4();",
											"const transferId = uuid.v4();",
											"const transferId2 = uuid.v4();",
											"const now = new Date();",
											"const headerDate = now.toUTCString();",
											"const expirationDate = new Date(now.getTime() + delay).toISOString();",
											"const completedTimestamp = now.toISOString();",
											"",
											"pm.environment.set(\"bulkTransferId\", bulkTransferId);",
											"pm.environment.set(\"bulkQuoteId\", bulkQuoteId);",
											"pm.environment.set(\"transferId\", transferId);",
											"pm.environment.set(\"transferId2\", transferId2);",
											"pm.environment.set(\"headerDate\", headerDate);",
											"pm.environment.set(\"expirationDate\", expirationDate);",
											"pm.environment.set(\"completedTimestamp\", completedTimestamp);",
											"pm.environment.set(\"amount\", 1);",
											"pm.environment.set(\"amount2\", 1);",
											"pm.environment.set(\"currency2\", \"USD\");",
											"pm.environment.set(\"acceptHeader\", \"application/vnd.interoperability.transfers+json;version=1\");",
											"pm.environment.set(\"contentType\", \"application/vnd.interoperability.bulkTransfers+json;version=1.0\");"
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "fd1be23c-8ac2-4501-9448-477b25617737",
										"exec": [
											"pm.test(\"Status code is 400\", function () {",
											"    pm.response.to.have.status(400);",
											"});",
											"",
											"pm.test(\"Scheme validation error is returned\", function () {",
											"    const res = pm.response.json();",
											"    pm.expect(res.errorInformation.errorCode).to.eql('3101');",
											"    pm.expect(res.errorInformation.errorDescription).to.eql('Malformed syntax - Invalid accept header');",
											"});",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"name": "Content-Type",
										"type": "text",
										"value": "{{contentType}}"
									},
									{
										"key": "Date",
										"value": "{{headerDate}}"
									},
									{
										"key": "Accept",
										"value": "{{acceptHeader}}"
									},
									{
										"key": "FSPIOP-Source",
										"value": "{{payerfsp}}"
									},
									{
										"key": "FSPIOP-Destination",
										"value": "{{payeefsp}}"
									},
									{
										"key": "FSPIOP-Signature",
										"type": "text",
										"value": "~~{{payerfsp}}~~"
									},
									{
										"key": "FSPIOP-URI",
										"type": "text",
										"value": "/bulkTransfers"
									},
									{
										"key": "FSPIOP-HTTP-Method",
										"value": "POST",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{ \n    \"bulkTransferId\": \"{{bulkTransferId}}\",\n    \"bulkQuoteId\": \"{{bulkQuoteId}}\",\n    \"payeeFsp\": \"{{payeefsp}}\",\n    \"payerFsp\": \"{{payerfsp}}\",\n    \"individualTransfers\":\n    [ {\n        \"transferId\": \"{{transferId}}\",\n        \"transferAmount\": {\n            \"currency\": \"{{currency}}\",\n            \"amount\": \"{{amount}}\"\n        },\n        \"ilpPacket\": \"{{validIlpPacket2}}\",\n        \"condition\": \"{{validCondition2}}\",\n        \"extensionList\": { \"extension\": [\n            { \"key\": \"extKey1\", \"value\": \"extValue1\"},\n            { \"key\": \"extKey2\", \"value\": \"extValue2\"}\n        ] }\n      },\n       {\n        \"transferId\": \"{{transferId2}}\",\n        \"transferAmount\": {\n            \"currency\": \"AED\",\n            \"amount\": \"{{amount2}}\"\n        },\n        \"ilpPacket\": \"{{validIlpPacket2}}\",\n        \"condition\": \"{{validCondition2}}\"\n    } ],\n    \"expiration\": \"{{expirationDate}}\"\n}"
								},
								"url": {
									"raw": "{{HOST_BULK_ADAPTER}}/bulkTransfers",
									"host": [
										"{{HOST_BULK_ADAPTER}}"
									],
									"path": [
										"bulkTransfers"
									]
								}
							},
							"response": []
						},
						{
							"name": "POST Bulk Transfer - Wrong Content-Type Header",
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"id": "92dd7487-5969-49d9-9b56-60498921fa63",
										"exec": [
											"const uuid = require('uuid');",
											"",
											"const delay = 1000 * 3600 * 24",
											"const bulkTransferId = uuid.v4();",
											"const bulkQuoteId = uuid.v4();",
											"const transferId = uuid.v4();",
											"const transferId2 = uuid.v4();",
											"const now = new Date();",
											"const headerDate = now.toUTCString();",
											"const expirationDate = new Date(now.getTime() + delay).toISOString();",
											"const completedTimestamp = now.toISOString();",
											"",
											"pm.environment.set(\"bulkTransferId\", bulkTransferId);",
											"pm.environment.set(\"bulkQuoteId\", bulkQuoteId);",
											"pm.environment.set(\"transferId\", transferId);",
											"pm.environment.set(\"transferId2\", transferId2);",
											"pm.environment.set(\"headerDate\", headerDate);",
											"pm.environment.set(\"expirationDate\", expirationDate);",
											"pm.environment.set(\"completedTimestamp\", completedTimestamp);",
											"pm.environment.set(\"amount\", 1);",
											"pm.environment.set(\"amount2\", 1);",
											"pm.environment.set(\"currency2\", \"USD\");",
											"pm.environment.set(\"acceptHeader\", \"application/vnd.interoperability.bulkTransfers+json;version=1\");",
											"pm.environment.set(\"contentType\", \"application/vnd.interoperability.transfers+json;version=1.0\");"
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "test",
									"script": {
										"id": "c2e58670-1ac3-4a9f-8b53-40b7019c3964",
										"exec": [
											"pm.test(\"Status code is 400\", function () {",
											"    pm.response.to.have.status(400);",
											"});",
											"",
											"pm.test(\"Scheme validation error is returned\", function () {",
											"    const res = pm.response.json();",
											"    pm.expect(res.errorInformation.errorCode).to.eql('3101');",
											"    pm.expect(res.errorInformation.errorDescription).to.eql('Malformed syntax - Invalid content-type header');",
											"});",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"name": "Content-Type",
										"type": "text",
										"value": "{{contentType}}"
									},
									{
										"key": "Date",
										"value": "{{headerDate}}"
									},
									{
										"key": "Accept",
										"value": "{{acceptHeader}}"
									},
									{
										"key": "FSPIOP-Source",
										"value": "{{payerfsp}}"
									},
									{
										"key": "FSPIOP-Destination",
										"value": "{{payeefsp}}"
									},
									{
										"key": "FSPIOP-Signature",
										"type": "text",
										"value": "~~{{payerfsp}}~~"
									},
									{
										"key": "FSPIOP-URI",
										"type": "text",
										"value": "/bulkTransfers"
									},
									{
										"key": "FSPIOP-HTTP-Method",
										"type": "text",
										"value": "POST"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{ \n    \"bulkTransferId\": \"{{bulkTransferId}}\",\n    \"bulkQuoteId\": \"{{bulkQuoteId}}\",\n    \"payeeFsp\": \"{{payeefsp}}\",\n    \"payerFsp\": \"{{payerfsp}}\",\n    \"individualTransfers\":\n    [ {\n        \"transferId\": \"{{transferId}}\",\n        \"transferAmount\": {\n            \"currency\": \"{{currency}}\",\n            \"amount\": \"{{amount}}\"\n        },\n        \"ilpPacket\": \"{{validIlpPacket2}}\",\n        \"condition\": \"{{validCondition2}}\",\n        \"extensionList\": { \"extension\": [\n            { \"key\": \"extKey1\", \"value\": \"extValue1\"},\n            { \"key\": \"extKey2\", \"value\": \"extValue2\"}\n        ] }\n      },\n       {\n        \"transferId\": \"{{transferId2}}\",\n        \"transferAmount\": {\n            \"currency\": \"AED\",\n            \"amount\": \"{{amount2}}\"\n        },\n        \"ilpPacket\": \"{{validIlpPacket2}}\",\n        \"condition\": \"{{validCondition2}}\"\n    } ],\n    \"expiration\": \"{{expirationDate}}\"\n}"
								},
								"url": {
									"raw": "{{HOST_BULK_ADAPTER}}/bulkTransfers",
									"host": [
										"{{HOST_BULK_ADAPTER}}"
									],
									"path": [
										"bulkTransfers"
									]
								}
							},
							"response": []
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				}
			],
			"protocolProfileBehavior": {}
		},
		{
			"name": "GET Bulk API Health",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"id": "daa7d1c0-2b47-489c-abc7-d5abac72016c",
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{HOST_BULK_ADAPTER}}/health",
					"host": [
						"{{HOST_BULK_ADAPTER}}"
					],
					"path": [
						"health"
					]
				}
			},
			"response": []
		}
	],
	"protocolProfileBehavior": {}
}